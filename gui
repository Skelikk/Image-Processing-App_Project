import tkinter as tk
from tkinter import ttk
from PIL import Image, ImageTk
import cv2
import numpy as np

img = Image.open("C:/Users/Admaj/Downloads/singals/Signal_Project/shit.jpg")

def brightness_control(img, brightness):

    img = np.array(img)
    img_1 = cv2.add(img, brightness)
    img_mod = Image.fromarray(cv2.cvtColor(img_1, cv2.COLOR_BGR2RGB))
    
    return img_mod

def resize_and_rotate(img, size=None, angle=0):
    
    img = np.array(img)
    
    if size is not None:
        img = cv2.resize(img, size, interpolation=cv2.INTER_LINEAR)
    
    (h, w) = img.shape[:2]
    cent = (w//2, h//2)
    
    rotation_matrix = cv2.getRotationMatrix2D(cent, angle, 1)  
    
    rotated_image = cv2.warpAffine(img, rotation_matrix, (w, h))
    rotated_image_mod = Image.fromarray(cv2.cvtColor(rotated_image, cv2.COLOR_BGR2RGB))
    
    return rotated_image_mod

def apply_changes():
    global img
    
    angle = rotation_var.get()
    brightness_value = brightness_slider.get()
    scale = scale_slider.get()

    img = brightness_control(img, brightness_value)
    img = resize_and_rotate(img, angle=angle, size=None)
    
    img_tk = ImageTk.PhotoImage(img)
    lbImg.config(image=img_tk)
    lbImg.image = img_tk

# Initialize the tkinter window and widgets
window = tk.Tk()
window.title("Image Processing Interface")
window.geometry("1000x800")

# Rotate value box
rotation_var = tk.IntVar(value=0)  
rotation_label = ttk.Label(window, text="Rotation (Â°):")
rotation_label.pack(pady=5)
rotation_menu = ttk.Combobox(window, textvariable=rotation_var, values=[0, 90, 180, 270])
rotation_menu.pack(pady=5)

# Display image
img = img.resize((500, 300))
img_tk = ImageTk.PhotoImage(img)
lbImg = tk.Label(window, image=img_tk)
lbImg.pack(side='bottom', pady=20)

# Brightness slider
brightness_label = ttk.Label(window, text="Brightness:")
brightness_label.pack(pady=5)
brightness_slider = tk.Scale(window, from_=-100, to=100, orient='horizontal', length=300)
brightness_slider.set(0)  # Default value
brightness_slider.pack(pady=5)

# Scale factor slider
scale_label = ttk.Label(window, text="Scale Factor:")
scale_label.pack(pady=5)
scale_slider = tk.Scale(window, from_=0.5, to=2.0, resolution=0.1, orient='horizontal', length=300)
scale_slider.set(1.0)  # Default value
scale_slider.pack(pady=5)

# Apply button
apply_button = ttk.Button(window, text="Apply Changes", command=apply_changes)
apply_button.pack(pady=20)

# Run the GUI
window.mainloop()